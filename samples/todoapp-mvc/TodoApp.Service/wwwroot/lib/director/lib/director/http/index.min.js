/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/director@1.2.8/lib/director/http/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var events=require("events"),qs=require("querystring"),util=require("util"),BaseRouter=require("../router").Router,responses=require("./responses");exports.methods=require("./methods"),Object.keys(responses).forEach((function(t){exports[t]=responses[t]}));var Router=exports.Router=function(t){this.params={},this.routes={},this.methods=["on","after","before"],this.scope=[],this._methods={},this.recurse="forward",this._attach=[],this.extend(exports.methods.concat(["before","after"])),this.configure(),this.mount(t||{})};util.inherits(Router,BaseRouter),Router.prototype.configure=function(t){return t=t||{},this.stream=t.stream||!1,BaseRouter.prototype.configure.call(this,t)},Router.prototype.on=function(t,e){var r,o=Array.prototype.slice.call(arguments,2),s=o.pop(),n=o.pop();n&&(n.stream&&(s.stream=!0),n.accept&&(this._hasAccepts=!0,r=n.accept,s.accept=(Array.isArray(r)?r:[r]).map((function(t){return"string"==typeof t?RegExp(t):t})))),"string"==typeof e||e.source||(e=""),BaseRouter.prototype.on.call(this,t,e,s)},Router.prototype.attach=function(t){this._attach.push(t)},Router.prototype.dispatch=function(t,e,r){var o,s,n,i,a,u="HEAD"===t.method?"get":t.method.toLowerCase(),c={req:t,res:e},p=this;try{a=decodeURI(t.url.split("?",1)[0])}catch(t){a=null}if(a&&this._hasAccepts?(o=t.headers["content-type"],i=this.traverse(u,a,this.routes,"",(function(t){return!t.accept||t.accept.some((function(t){return t.test(o)}))}))):a&&(i=this.traverse(u,a,this.routes,"")),this._attach)for(var h=0;h<this._attach.length;h++)this._attach[h].call(c);if(!i||0===i.length)return n=new exports.NotFound("Could not find path: "+t.url),"function"==typeof this.notfound?this.notfound.call(c,r):r&&r.call(c,n,t,e),!1;function f(){if(n=p.parse(t))return r&&r.call(c,n,t,e),!1;p.invoke(s,c,r)}return"forward"===this.recurse&&(i=i.reverse()),s=this.runlist(i),this.stream||s.some((function(t){return!0===t.stream}))?this.invoke(s,c,r):t.readable?(t.once("end",f),t.resume()):f(),!0},Router.prototype.parsers={"application/x-www-form-urlencoded":qs.parse,"application/json":JSON.parse},Router.prototype.parse=function(t){var e=this.parsers[function(t){return(t.headers["content-type"]||"").split(";")[0]}(t)];if(e&&(t.body=t.body||"",t.chunks&&t.chunks.forEach((function(e){t.body+=e})),"string"==typeof t.body))try{t.body=t.body&&t.body.length?e(t.body):{}}catch(t){return new exports.BadRequest("Malformed data")}};
//# sourceMappingURL=/sm/185c15f5b7be41723337cecaca4bfef06cad29a1afca125f8381b7866e0a314a.map