/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/director@1.2.8/lib/director/router.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var QUERY_SEPARATOR=/\?.*/;function _flatten(t){for(var e=[],r=0,i=t.length;r<i;r++)e=e.concat(t[r]);return e}function _every(t,e){for(var r=0;r<t.length;r+=1)if(!1===e(t[r],r,t))return}function _asyncEverySeries(t,e,r){if(!t.length)return r();var i=0;!function n(){e(t[i],(function(e){e||!1===e?(r(e),r=function(){}):(i+=1)===t.length?r():n()}))}()}function paramifyString(t,e,r){for(var i in r=t,e)if(e.hasOwnProperty(i)&&(r=e[i](t))!==t)break;return r===t?"([._a-zA-Z0-9-%()]+)":r}function regifyString(t,e){for(var r,i=0,n="";r=t.substr(i).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/);)i=r.index+r[0].length,r[0]=r[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),n+=t.substr(0,r.index)+r[0];var o,s,a=(t=n+=t.substr(i)).match(/:([^\/]+)/gi);if(a){s=a.length;for(var c=0;c<s;c++)t="::"===(o=a[c]).slice(0,2)?o.slice(1):t.replace(o,paramifyString(o,e))}return t}function terminator(t,e,r,i){var n,o=0,s=0,a=0;r=(r||"(").toString(),i=(i||")").toString();for(n=0;n<t.length;n++){var c=t[n];if(c.indexOf(r,o)>c.indexOf(i,o)||~c.indexOf(r,o)&&!~c.indexOf(i,o)||!~c.indexOf(r,o)&&~c.indexOf(i,o)){if(s=c.indexOf(r,o),a=c.indexOf(i,o),~s&&!~a||!~s&&~a){var f=t.slice(0,(n||1)+1).join(e);t=[f].concat(t.slice((n||1)+1))}o=(a>s?a:s)+1,n=0}else o=0}return t}var Router=exports.Router=function(t){this.params={},this.routes={},this.methods=["on","after","before"],this.scope=[],this._methods={},this.configure(),this.mount(t||{})};Router.prototype.configure=function(t){t=t||{};for(var e=0;e<this.methods.length;e++)this._methods[this.methods[e]]=!0;return this.recurse=void 0===t.recurse?this.recurse||!1:t.recurse,this.async=t.async||!1,this.delimiter=t.delimiter||"/",this.strict=void 0===t.strict||t.strict,this.notfound=t.notfound,this.resource=t.resource,this.history=t.html5history&&this.historySupport||!1,this.run_in_init=!0===this.history&&!1!==t.run_handler_in_init,this.convert_hash_in_init=!0===this.history&&!1!==t.convert_hash_in_init,this.every={after:t.after||null,before:t.before||null,on:t.on||null},this},Router.prototype.param=function(t,e){":"!==t[0]&&(t=":"+t);var r=new RegExp(t,"g");return this.params[t]=function(t){return t.replace(r,e.source||e)},this},Router.prototype.on=Router.prototype.route=function(t,e,r){var i=this;return r||"function"!=typeof e||(r=e,e=t,t="on"),Array.isArray(e)?e.forEach((function(e){i.on(t,e,r)})):(e.source&&(e=e.source.replace(/\\\//gi,"/")),Array.isArray(t)?t.forEach((function(t){i.on(t.toLowerCase(),e,r)})):(e=terminator(e=e.split(new RegExp(this.delimiter)),this.delimiter),void this.insert(t,this.scope.concat(e),r)))},Router.prototype.path=function(t,e){var r=this.scope.length;t.source&&(t=t.source.replace(/\\\//gi,"/")),t=terminator(t=t.split(new RegExp(this.delimiter)),this.delimiter),this.scope=this.scope.concat(t),e.call(this,this),this.scope.splice(r,t.length)},Router.prototype.dispatch=function(t,e,r){var i,n=this,o=this.traverse(t,e.replace(QUERY_SEPARATOR,""),this.routes,""),s=this._invoked;if(this._invoked=!0,!o||0===o.length)return this.last=[],"function"==typeof this.notfound&&this.invoke([this.notfound],{method:t,path:e},r),!1;function a(){n.last=o.after,n.invoke(n.runlist(o),n,r)}return"forward"===this.recurse&&(o=o.reverse()),(i=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last])&&i.length>0&&s?(this.async?this.invoke(i,this,a):(this.invoke(i,this),a()),!0):(a(),!0)},Router.prototype.runlist=function(t){var e=this.every&&this.every.before?[this.every.before].concat(_flatten(t)):_flatten(t);return this.every&&this.every.on&&e.push(this.every.on),e.captures=t.captures,e.source=t.source,e},Router.prototype.invoke=function(t,e,r){var i,n=this;this.async?(i=function(r,n){if(Array.isArray(r))return _asyncEverySeries(r,i,n);"function"==typeof r&&r.apply(e,(t.captures||[]).concat(n))},_asyncEverySeries(t,i,(function(){r&&r.apply(e,arguments)}))):(i=function(r){return Array.isArray(r)?_every(r,i):"function"==typeof r?r.apply(e,t.captures||[]):void("string"==typeof r&&n.resource&&n.resource[r].apply(e,t.captures||[]))},_every(t,i))},Router.prototype.traverse=function(t,e,r,i,n){var o,s,a,c,f=[];function h(t){if(!n)return t;var e=function t(e){for(var r=[],i=0;i<e.length;i++)r[i]=Array.isArray(e[i])?t(e[i]):e[i];return r}(t);return e.matched=t.matched,e.captures=t.captures,e.after=t.after.filter(n),function t(e){for(var r=e.length-1;r>=0;r--)Array.isArray(e[r])?(t(e[r]),0===e[r].length&&e.splice(r,1)):n(e[r])||e.splice(r,1)}(e),e}if(e===this.delimiter&&r[t])return(c=[[r.before,r[t]].filter(Boolean)]).after=[r.after].filter(Boolean),c.matched=!0,c.captures=[],h(c);for(var u in r)if(r.hasOwnProperty(u)&&(!this._methods[u]||this._methods[u]&&"object"==typeof r[u]&&!Array.isArray(r[u]))){if(o=s=i+this.delimiter+u,this.strict||(s+="["+this.delimiter+"]?"),!(a=e.match(new RegExp("^"+s))))continue;if(a[0]&&a[0]==e&&r[u][t])return(c=[[r[u].before,r[u][t]].filter(Boolean)]).after=[r[u].after].filter(Boolean),c.matched=!0,c.captures=a.slice(1),this.recurse&&r===this.routes&&(c.push([r.before,r.on].filter(Boolean)),c.after=c.after.concat([r.after].filter(Boolean))),h(c);if((c=this.traverse(t,e,r[u],o)).matched)return c.length>0&&(f=f.concat(c)),this.recurse&&(f.push([r[u].before,r[u][t]].filter(Boolean)),c.after=c.after.concat([r[u].after].filter(Boolean)),r===this.routes&&(f.push([r.before,r.on].filter(Boolean)),c.after=c.after.concat([r.after].filter(Boolean)))),f.matched=!0,f.captures=c.captures,f.after=c.after,h(f)}return!1},Router.prototype.insert=function(t,e,r,i){var n,o,s,a;if(e=e.filter((function(t){return t&&t.length>0})),i=i||this.routes,a=e.shift(),/\:|\*/.test(a)&&!/\\d|\\w/.test(a)&&(a=regifyString(a,this.params)),e.length>0)return i[a]=i[a]||{},this.insert(t,e,r,i[a]);if(a||e.length||i!==this.routes){if(n=typeof i[a],o=Array.isArray(i[a]),i[a]&&!o&&"object"==n)switch(typeof i[a][t]){case"function":return void(i[a][t]=[i[a][t],r]);case"object":return void i[a][t].push(r);case"undefined":return void(i[a][t]=r)}else if("undefined"==n)return(s={})[t]=r,void(i[a]=s);throw new Error("Invalid route context: "+n)}switch(typeof i[t]){case"function":return void(i[t]=[i[t],r]);case"object":return void i[t].push(r);case"undefined":return void(i[t]=r)}},Router.prototype.extend=function(t){var e,r=this,i=t.length;function n(t){r._methods[t]=!0,r[t]=function(){var e=1===arguments.length?[t,""]:[t];r.on.apply(r,e.concat(Array.prototype.slice.call(arguments)))}}for(e=0;e<i;e++)n(t[e])},Router.prototype.mount=function(t,e){if(t&&"object"==typeof t&&!Array.isArray(t)){var r=this;for(var i in e=e||[],Array.isArray(e)||(e=e.split(r.delimiter)),t)t.hasOwnProperty(i)&&n(i,e.slice(0))}function n(e,i){var n=e,o=e.split(r.delimiter),s=typeof t[e],a=""===o[0]||!r._methods[o[0]],c=a?"on":n;if(a&&(n=n.slice((n.match(new RegExp("^"+r.delimiter))||[""])[0].length),o.shift()),a&&"object"===s&&!Array.isArray(t[e]))return i=i.concat(o),void r.mount(t[e],i);a&&(i=terminator(i=i.concat(n.split(r.delimiter)),r.delimiter)),r.insert(c,i,t[e])}};
//# sourceMappingURL=/sm/187af88e8c511ae1ff2b34af08440c20e2b197afaea7ae2de8de016223e8b46a.map